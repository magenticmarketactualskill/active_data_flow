# frozen_string_literal: true

class <%= class_name %>Flow
  def self.register
    source = ActiveDataFlow::Connector::Source::ActiveRecordSource.new(
      model_class: SourceModel,
      scope_name: :active
    )

    sink = ActiveDataFlow::Connector::Sink::ActiveRecordSink.new(
      model_class: DestinationModel,
      batch_size: 100
    )

    runtime = ActiveDataFlow::Runtime::Base.new(
      interval: 3600,
      batch_size: 100,  # Source iteration batch size
      enabled: true     # Whether the data flow is enabled
    )

    ActiveDataFlow::DataFlow.find_or_create(
      name: "<%= file_name %>",
      source: source,
      sink: sink,
      runtime: runtime
    )
  end
end

# Note: The .register method is automatically called by config/initializers/data_flows.rb
# after ActiveRecord is available. You don't need to call it manually.
